.ui-dropdown {
  position: relative;
}
.ui-search-dropdown {
  display: none;
  position: absolute;
  z-index: 100;
  background: var(--bg-input);
  max-height: 12rem;
  overflow-y: auto;
  /* ... Custom scrollbar ... */
}
.ui-search-dropdown.open {
  display: block;
}
.dropdown-focus .ui-dropdown-indicator {
  transform: translateY(-50%) rotate(180deg);
}
/* icon trái */
.ui-dropdown > i:not(.ui-dropdown-indicator) {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-muted);
  pointer-events: none;
}
/* input */
.ui-dropdown .ui-input {
  padding-left: 2.5rem; /* icon trái */
  padding-right: 2.5rem; /* arrow phải */
}

.ui-dropdown-panel {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  z-index: 50;
  background: var(--bg-card);
  border: 1px solid var(--border-main);
  border-radius: 0.5rem;
  max-height: 220px;
  overflow-y: auto;
  display: none;
}

.ui-dropdown-panel.open {
  display: block;
}

.ui-dropdown-panel li {
  padding: 0.5rem 0.75rem;
  cursor: pointer;
}

.ui-dropdown-indicator {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.8rem;
  color: var(--text-muted);
  pointer-events: none; /* Quan trọng: để click xuyên qua vào input */
  transition:
    transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
    color 0.2s ease;
}

/* Hiệu ứng khi Dropdown đang mở (dựa vào class dropdown-focus từ JS) */
.ui-field.dropdown-focus .ui-dropdown-indicator {
  transform: translateY(-50%) rotate(180deg); /* Xoay ngược lên */
  color: var(--primary); /* Đổi màu sang màu chủ đạo */
}

/* Đảm bảo icon caret xoay đúng khi focus vào field */
.ui-field:focus-within .ui-dropdown-indicator {
  transform: translateY(-50%) rotate(180deg);
  color: var(--primary);
}

.ui-dropdown-panel li:hover {
  background: var(--bg-hover);
}

.ui-dropdown-item {
  padding: 0.5rem 0.75rem;
  cursor: pointer;
}
.ui-dropdown-item:hover {
  background: #e5f0ff;
}

/* =====================================================
   SEARCH DROPDOWN – BASE COMPONENT
   Áp dụng cho tất cả dropdown custom
===================================================== */

.ui-search-dropdown {
  /* Ẩn mặc định */
  display: none;

  /* Positioning */
  position: absolute;
  top: 100%;
  left: 0;
  width: 100%;
  margin-top: 4px;

  /* Size & scroll */
  max-height: 12rem;
  overflow-y: auto;

  /* Visual */
  background: var(--bg-input);
  color: var(--text-main);
  border: 1px solid var(--border-main);
  border-radius: 0.5rem;

  /* Elevation */
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
  z-index: 100;
  scrollbar-width: thin; /* Firefox: Thanh cuộn nhỏ */
  scrollbar-color: var(--border-main) transparent; /* Firefox: Màu thumb và track */
}
/* Tùy chỉnh cho Chrome, Safari, Edge (Webkit) */
.ui-search-dropdown::-webkit-scrollbar {
  width: 6px; /* Độ rộng thanh cuộn */
}
.ui-search-dropdown::-webkit-scrollbar-track {
  background: transparent; /* Nền của thanh cuộn trong suốt để lộ màu nền dropdown */
  border-radius: 0 0 0.5rem 0; /* Bo góc khớp với dropdown */
}
.ui-search-dropdown::-webkit-scrollbar-thumb {
  background-color: var(
    --border-main
  ); /* Màu của thanh trượt dùng biến màu viền */
  border-radius: 20px; /* Bo tròn thanh trượt */
  border: 2px solid transparent; /* Tạo khoảng trống nhẹ quanh thanh trượt */
}
.ui-search-dropdown::-webkit-scrollbar-thumb:hover {
  background-color: var(
    --text-muted
  ); /* Khi di chuột vào thanh trượt sẽ đậm hơn */
}

/* Mở dropdown */
.ui-search-dropdown.open {
  display: block;
}
.ui-search-dropdown .ui-dropdown-item {
  padding: 0.65rem 0.85rem;
  font-size: 0.85rem;
  color: var(--text-main);
  transition:
    background 0.15s ease,
    color 0.15s ease;
}

/* Hover item đồng bộ với theme */
.ui-search-dropdown .ui-dropdown-item:hover {
  background-color: var(--bg-hover);
  color: var(--primary);
}
/* Đồng bộ Border cho Dark Mode */
.dark .ui-search-dropdown {
  background-color: var(--bg-card);
  border-color: var(--border-main);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

/* Cách chuẩn (browser hiện đại) */
.ui-field:has(.ui-input:focus) .ui-search-dropdown.open {
  border-color: var(--border-focus);
  box-shadow:
    0 0 0 2px rgba(37, 99, 235, 0.15),
    0 8px 20px rgba(0, 0, 0, 0.12);
}

/* Fallback cho browser cũ */
.ui-field.dropdown-focus .ui-search-dropdown {
  border-color: var(--border-focus);
  box-shadow:
    0 0 0 2px rgba(37, 99, 235, 0.15),
    0 8px 20px rgba(0, 0, 0, 0.12);
}
